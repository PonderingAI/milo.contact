"use client"

import { useState } from "react"
import VulnerabilityItem from "./vulnerability-item"
import VulnerabilityChart from "./vulnerability-chart"

interface Vulnerability {
  id: string
  packageName: string
  severity: "critical" | "high" | "medium" | "low"
  description: string
  fixedIn: string
}

export default function VulnerabilityDetails() {
  const [vulnerabilities, setVulnerabilities] = useState<Vulnerability[]>([
    {
      id: "vuln-1",
      packageName: "lodash",
      severity: "high",
      description: "Prototype pollution vulnerability in lodash",
      fixedIn: "4.17.21",
    },
    {
      id: "vuln-2",
      packageName: "axios",
      severity: "medium",
      description: "Server-side request forgery vulnerability",
      fixedIn: "0.21.2",
    },
    {
      id: "vuln-3",
      packageName: "react-dom",
      severity: "low",
      description: "Cross-site scripting vulnerability",
      fixedIn: "17.0.2",
    },
  ])

  const severityCounts = {
    critical: vulnerabilities.filter((v) => v.severity === "critical").length,
    high: vulnerabilities.filter((v) => v.severity === "high").length,
    medium: vulnerabilities.filter((v) => v.severity === "medium").length,
    low: vulnerabilities.filter((v) => v.severity === "low").length,
  }

  return (
    <div className="space-y-4">
      <h3 className="text-lg font-medium text-gray-900">Vulnerabilities</h3>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div className="bg-white rounded-md border border-gray-200 p-4">
          <VulnerabilityChart severityCounts={severityCounts} />
        </div>

        <div className="bg-white rounded-md border border-gray-200 overflow-hidden">
          <div className="bg-gray-50 px-4 py-2 border-b border-gray-200 text-xs font-medium text-gray-500 uppercase tracking-wider">
            Details
          </div>

          <div className="max-h-[200px] overflow-y-auto">
            {vulnerabilities.length === 0 ? (
              <div className="p-4 text-center text-gray-500">No vulnerabilities found</div>
            ) : (
              vulnerabilities.map((vulnerability) => (
                <VulnerabilityItem key={vulnerability.id} vulnerability={vulnerability} />
              ))
            )}
          </div>
        </div>
      </div>
    </div>
  )
}
